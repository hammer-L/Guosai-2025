问题一：基于广义加性模型的Y染色体浓度预测
针对问题一，我们首先进行数据预处理，然后通过相关系数热力图分析，筛选出与Y染色体浓度相关性较高的三个变量。初步尝试线性回归，尽管F检验结果显示男胎Y染色体浓度与孕周和BMI之间存在显著关系，但线性模型的决定系数（R^2）较低。为此，我们引入了广义加性模型（GAM）进行拟合，并将其与基于“稀释/比例”隐函数模型的性能进行对比。最终结果表明，GAM模型在训练集和测试集上的均方误差（MSE）最小，取得了最佳的预测效果。

问题二：结合K-means与Copula模型对BMI分群优化建模
在确认孕妇BMI对男胎Y染色体浓度的显著影响后，我们结合肘部法则和 K-means 聚类算法对BMI进行初步分组，并通过实际情况进行二次优化以增强组内一致性。在此基础上，我们针对不同BMI区间建立了独立的数学模型：对于BMI在$[27.5, 38]$的样本，我们采用Gaussian Copula模型以平衡NIPT检测的准确率与孕妇风险；对于BMI大于38的样本，则沿用第一部分表现最佳的GAM模型进行预测。为了量化最佳检测时点，我们引入了效用函数U(t)和临床风险 C(t)。模型的最终诊断通过 QQ 图和 Kendall’s τ 进行评估。

问题三：多变量 Copula 模型
在问题二的建模基础上，我们引入多个自变量和检测误差，共同构建了一个 Copula 数学模型，以求得最佳的检测时点。其中Y染色体浓度的检测误差根据已有研究，被近似处理为服从二项分布。效用函数仍沿用第二问的模型。最终，通过将模型的拟合值与各变量的实际值进行对比，我们验证了该模型具有良好的拟合效果。综合对比前面模型可得，BMI ∈ [27, 31.5] 时，最佳检测时点约为 12.5周；BMI ∈ [31.5, 33.5]时，最佳检测时点为 13周；BMI ∈ [33.5, 38] 时，最佳检测时点约为 15周，同时应进行多次检测。

问题四：基于随机森林和穷举法的特征筛选
为了确保训练集和测试集划分的合理性，我们首先剔除了样本量少于两例的类别，以避免分层抽样失败。我们针对11个候选特征，采用穷举特征组合的方法，对每一种组合使用 随机森林模型（树数=100，最大深度=6）进行五折交叉验证，并计算其平均准确率。通过比较所有组合的交叉验证表现，我们筛选出表现最佳的Top 5特征组合，并以其中最优组合作为最终模型的输入特征。最后，我们基于最佳特征组合训练了随机森林模型，并在测试集上进行预测，通过混淆矩阵直观地展示了模型的分类性能。

关键词
NIPT无创产前检测、‘稀释/比例’隐函数模型、广义加性模型（GAM）、K-means 聚类分析、Copula、随机森林、混淆矩阵

    在图中标记三条BMI分组曲线的峰值，我们确定了各组的最佳检测时点：当 BMI ∈ [27, 31.5] 时，最佳时点约为 12.5 周；当 BMI ∈ [31.5, 33.5] 时，最佳时点为 13 周；当 BMI ∈ [33.5, 38] 时，最佳时点则约为 15 周。
    值得注意的是，尽管 BMI ∈ [33.5, 38] 组的最佳检测时点显著晚于其他两组，但参考图10可知，该组在15周时的检测准确率仅为80%，而其余两组在各自最佳时点的准确率均在88%左右。
    为了提高检验结果的可靠性，我们建议：
1.对于 BMI ∈ [27, 31.5] 和 BMI ∈ [31.5, 33.5] 这两组，可在各自最佳检测时点进行首次检测后，于两周后再次进行检测。
2.对于 BMI ∈ [33.5, 38] 组，我们建议采取更积极的策略，不仅可以考虑多次采血多次检验，还应考虑一次采血多次检测，以最大限度地提升结果的可靠性。

